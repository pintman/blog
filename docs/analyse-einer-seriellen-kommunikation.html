<!DOCTYPE html>
<html lang="de" prefix="og: http://ogp.me/ns# fb: https://www.facebook.com/2008/fbml">
<head>
    <title>Analyse einer seriellen Kommunikation - /home/bakera/blog</title>
    <!-- Using the latest rendering mode for IE -->
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">



<link rel="canonical" href="https://blog.bakera.de/analyse-einer-seriellen-kommunikation.html">

        <meta name="author" content="marco.bakera" />
        <meta name="keywords" content="Hardware,Informatik,Bus Pirate,Logic Analyzer,Logic Sniffer,Trinket Pro" />
        <meta name="description" content="Diesmal habe ich mir die Kommunikation über eine serielle Schnittstelle angeschaut. Und zwar auf der untersten Ebene, da, wo die digitalen Signale über die Leitung gehen und man die Bits noch rauschen hört. Dazu habe ich auf der einen Seite einen Mikrocontroller verwendet, der auf die serielle Schnittstelle schreibt und …" />

        <meta property="og:site_name" content="/home/bakera/blog" />
        <meta property="og:type" content="article"/>
        <meta property="og:title" content="Analyse einer seriellen Kommunikation"/>
        <meta property="og:url" content="https://blog.bakera.de/analyse-einer-seriellen-kommunikation.html"/>
        <meta property="og:description" content="Diesmal habe ich mir die Kommunikation über eine serielle Schnittstelle angeschaut. Und zwar auf der untersten Ebene, da, wo die digitalen Signale über die Leitung gehen und man die Bits noch rauschen hört. Dazu habe ich auf der einen Seite einen Mikrocontroller verwendet, der auf die serielle Schnittstelle schreibt und …"/>
        <meta property="article:published_time" content="2015-01-21" />
            <meta property="article:section" content="Sonstiges" />
            <meta property="article:tag" content="Hardware" />
            <meta property="article:tag" content="Informatik" />
            <meta property="article:tag" content="Bus Pirate" />
            <meta property="article:tag" content="Logic Analyzer" />
            <meta property="article:tag" content="Logic Sniffer" />
            <meta property="article:tag" content="Trinket Pro" />
            <meta property="article:author" content="marco.bakera" />


    <!-- Bootstrap -->
        <link rel="stylesheet" href="https://blog.bakera.de/theme/css/bootstrap.min.css" type="text/css"/>
    <link href="https://blog.bakera.de/theme/css/font-awesome.min.css" rel="stylesheet">

    <link href="https://blog.bakera.de/theme/css/pygments/native.css" rel="stylesheet">
    <link href="https://blog.bakera.de/theme/tipuesearch/tipuesearch.css" rel="stylesheet">
    <link rel="stylesheet" href="https://blog.bakera.de/theme/css/style.css" type="text/css"/>

        <link href="https://blog.bakera.de/feeds/all.atom.xml" type="application/atom+xml" rel="alternate"
              title="/home/bakera/blog ATOM Feed"/>




</head>
<body>

<div class="navbar navbar-default navbar-fixed-top" role="navigation">
	<div class="container">
        <div class="navbar-header">
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-ex1-collapse">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            <a href="https://blog.bakera.de/" class="navbar-brand">
/home/bakera/blog            </a>
        </div>
        <div class="collapse navbar-collapse navbar-ex1-collapse">
            <ul class="nav navbar-nav">
                         <li><a href="https://blog.bakera.de/pages/impressum.html">
                             Impressum, Datenschutz
                          </a></li>
                         <li><a href="https://blog.bakera.de/pages/wiki.html">
                             Wiki
                          </a></li>
                         <li><a href="https://blog.bakera.de/pages/about.html">
                             Über
                          </a></li>
            </ul>
            <ul class="nav navbar-nav navbar-right">
              <li><span>
                <form class="navbar-search" action="/search.html">
                  <input type="text" class="search-query" placeholder="Search" name="q" id="tipue_search_input" required>
                </form></span>
              </li>
            </ul>
        </div>
        <!-- /.navbar-collapse -->
    </div>
</div> <!-- /.navbar -->
<!-- Banner -->
<!-- End Banner -->
<div class="container">
    <div class="row">
        <div class="col-sm-9">
    <section id="content">
        <article>
            <header class="page-header">
                <h1>
                    <a href="https://blog.bakera.de/analyse-einer-seriellen-kommunikation.html"
                       rel="bookmark"
                       title="Permalink to Analyse einer seriellen Kommunikation">
                        Analyse einer seriellen Kommunikation
                    </a>
                </h1>
            </header>
            <div class="entry-content">
                <div class="panel">
                    <div class="panel-body">
<footer class="post-info">
    <span class="label label-default">Date</span>
    <span class="published">
        <i class="fa fa-calendar"></i><time datetime="2015-01-21T18:58:00+01:00"> Mi 21 Januar 2015</time>
    </span>





<span class="label label-default">Tags</span>
	<a href="https://blog.bakera.de/tag/hardware.html">Hardware</a>
        /
	<a href="https://blog.bakera.de/tag/informatik.html">Informatik</a>
        /
	<a href="https://blog.bakera.de/tag/bus-pirate.html">Bus Pirate</a>
        /
	<a href="https://blog.bakera.de/tag/logic-analyzer.html">Logic Analyzer</a>
        /
	<a href="https://blog.bakera.de/tag/logic-sniffer.html">Logic Sniffer</a>
        /
	<a href="https://blog.bakera.de/tag/trinket-pro.html">Trinket Pro</a>
    
</footer><!-- /.post-info -->                    </div>
                </div>
                <p><img alt="SerielleKommunikation_Aufbau" class="alignnone size-large wp-image-1563" src="https://blog.bakera.de/images/2014/12/SerielleKommunikation_Aufbau-1021x1024.jpg" style="width: 625px; height: 626px;" /></p>
<p>Diesmal habe ich mir die Kommunikation über eine serielle Schnittstelle
angeschaut. Und zwar auf der untersten Ebene, da, wo die digitalen
Signale über die Leitung gehen und man die Bits noch rauschen hört. Dazu
habe ich auf der einen Seite einen Mikrocontroller verwendet, der auf
die serielle Schnittstelle schreibt und auf der anderen Seite einen
<a class="reference external" href="https://de.wikipedia.org/wiki/Logikanalysator">Logikanalysator</a>, mit
dem ich die geschriebenen Daten auswerten kann.</p>
<p>Oben seht ihr den einfachen Aufbau bestehend aus einem <a class="reference external" href="http://dangerousprototypes.com/docs/Bus_Pirate">Bus
Pirate</a>, den ich als
Logikanalysator betreiben werde, und einem <a class="reference external" href="https://learn.adafruit.com/introducing-pro-trinket?view=all">Trinket
Pro</a> mit
einem Mikrocontroller - so eine Art kleiner Arduino. Die serielle
Ausgabe TX des Trinket Pro ist über ein Kabel mit dem Eingang MISO
(Master In Slave Out - so eine Art generischer Eingang) des Bus Pirate
verbunden. Der Bus Pirate versorgt den Trinket zusätzlich über 5V mit
Strom.</p>
<p>Der Quelltext, der auf dem Trinket läuft, ist einfach gehalten und unten
abgebildet. Zunächst folgt die Setup-Routine, die beim Start des Trinket
ausgeführt wird.</p>
<pre class="literal-block">
void setup() {
&nbsp; pinMode(13, OUTPUT);
&nbsp; Serial.begin(300);
}
</pre>
<p>Hier wird Pin 13 - eine on-Board LED - als Ausgabe konfiguriert. Sie
soll später nur blinken und dadurch signalisieren, dass das Programm
läuft. Sie hat keine weitere Funktion für dieses Projekt.</p>
<p>Die Geschwindigkeit der seriellen Schnittstelle wird für mickrige 300
Baud konfiguriert. Da ich die Ausgabe später anschauen möchte, habe ich
die Geschwindigkeit bewusst sehr langsam eingestellt.</p>
<pre class="literal-block">
void loop() {
&nbsp; digitalWrite(13, HIGH);
&nbsp; Serial.write(0b01010101);
&nbsp; delay(100);
&nbsp; digitalWrite(13, LOW);
&nbsp; Serial.write(0b10000001);
&nbsp; delay(100);
}
</pre>
<p>Die Hauptschleife befindet sich in der Methode loop. Sie wird immer
wieder ausgeführt und schaltet abwechselnd die LED an (HIGH) und wieder
aus (LOW). Das hat eigentlich keine Funktion, sondern dient nur der
Funktionskontrolle des Controllers.</p>
<p>Zusätzlich sende ich auf die serielle Schnittstelle das Bitmuster
01010101, warte ein paar Millisekunden und sende anschließend das
Bitmuster 10000001. Das voran gestellte &quot;0b&quot; signalisiert, dass die
folgende Zahl keine Dezimalzahl, sondern eine binäre Zahl bestehend aus
0en und 1en darstellt. Ich habe die Hoffnung, dass ich die beiden
Bitmuster im Logic-Sniffer gut wiedererkennen kann.</p>
<p>Nun wird der BusPirate entsprechend der obigen Verkabelung an die
serielle Schnittstelle angeschlossen. Mit dem Programm <a class="reference external" href="http://www.lxtreme.nl/ols/">OLS
Client</a> kann ich die Kommunikation
mitschneiden. OLS steht hierbei für Open Bench Logic Sniffer. Die
folgende Abbildung zeigt einen Mitschnitt, den ich um die
korrespondierenden Quelltextzeilen ergänzt habe.</p>
<p><img alt="LogicSniffer" class="alignnone size-large wp-image-1567" src="https://blog.bakera.de/images/2014/12/LogicSniffer-1024x120.png" style="width: 625px; height: 73px;" /></p>
<p>Und tatsächlich kann man im LogicSniffer die Impulse als Bitmuster und
die Pause von 100ms zwischen den beiden Sendungen wiedererkennen. Das
Programm kann sogar versuchen, den Bitstrom zu rekonstruieren, wenn wir
wissen, dass es sich um eine Kommunikation über die serielle
Schnittstelle handelt. Das ist nicht selbstverständlich. So könnte der
Logikanlysator auch die Kommunikation eines anderen Buses mitgehört
haben.</p>
<p><img alt="OLS-Analyse" class="alignnone size-full wp-image-1561" src="https://blog.bakera.de/images/2014/12/OLS-Analyse.png" style="width: 935px; height: 468px;" /></p>
<p>Links oben können wir die einzelnen Pins den aufgezeichneten Kanälen
zuordnen. Links in der Mitte stellen wir 300 Baud als
Übertragungsgeschwindigkeit ein. Und tatsächlich taucht das versendete
Bitmuster in der Analyse wieder auf (rot markiert). Die zugehörigen
Hexwerte 0x55 und 0x81 hatte der Sniffer bereits im obigen Logikdiagramm
erkannt und eingetragen.</p>
<p>Mich hat erstaunt, dass es wenig Rauschen um die eigentlichen Nutzdaten
der beiden Bitmuster gibt. Im Wesentlichen werden die Bitmuster genau in
den Signalen abgebildet.</p>

            </div>
            <!-- /.entry-content -->
            	<style>
#pcs-comment-form input,
#pcs-comment-form textarea {
	width: 100%;
}
#pcs-comment-form-display-replyto {
	border: solid 1px black;
	padding: 2px;
}
#pcs-comment-form-display-replyto p {
	margin-top: 0.5em;
	margin-bottom: 0.5em;
}
#pcs-comments ul {
	list-style: none;
}
#pcs-comments .comment-left {
	display: table-cell;
	padding-right: 10px;
}
#pcs-comments .comment-body {
	display: table-cell;
	vertical-align: top;
	width: 100%;
}
</style>

	<section id="pcs-comments">
	<header>
		<h2>Comments</h2>
		<hr/>
	</header>
		<p>There are no comments yet.</p>
	<section>
	<form id="pcs-comment-form" action="#">
		<legend>Add a Comment</legend>
		<input type="hidden" id="pcs-comment-form-input-replyto">
		<fieldset>
			<label for="pcs-comment-form-input-name">Name</label>
			<input  id="pcs-comment-form-input-name" type="text" placeholder="Enter your name or nickname" />
		</fieldset>
		<fieldset>
			<label for="pcs-comment-form-input-website">Website</label>
			<input  id="pcs-comment-form-input-website" type="text" placeholder="Enter your website (optional)" />
		</fieldset>
		<fieldset>
			<label   for="pcs-comment-form-input-textarea">Your Comment</label>
			<textarea id="pcs-comment-form-input-textarea" rows="5" style="resize:vertical;" placeholder="Your comment"></textarea>
			<p>You can use the <a href="https://en.wikipedia.org/wiki/Markdown">Markdown</a> syntax to format your comment.</p>
			<div style="display: none; " id="pcs-comment-form-display-replyto"></div>
		</fieldset>

		<button type="submit"
				id="pcs-comment-form-button-submit"
				>Post via email</button>

			<a href="https://blog.bakera.de/feeds/comment.analyse-einer-seriellen-kommunikation.atom.xml">
				Comment Atom Feed
			</a>
	</form>
</section>

</section>

			<script type="text/javascript" src="https://code.jquery.com/jquery-2.1.4.min.js"></script>
	<script type="text/javascript" src="https://blog.bakera.de/theme/js/comments.js"></script>
	<script type="text/javascript">
		$(document).ready(function() {
			CommentSystem.email_user   = "pintman";
			CommentSystem.email_domain = "bakera.de";
			CommentSystem.display_replyto_html = function(comment_content, article_slug, author) { 
				return ''
					+ '<button style="float:right;" onclick="CommentSystem.cancelReply(); return false;" title="Cancel the reply">'
					+ 	'×'
					+ '</button>'
					+ '<p>This comment will be posted as a reply to \'<a title="'+comment_content+'" href="#comment-'+article_slug+'">'+author+'</a>\'</p>';
			};

			$('#pcs-comment-form').on("submit",
				function( event )
				{
					event.preventDefault();
					$(location).attr('href', CommentSystem.getMailtoLink("analyse-einer-seriellen-kommunikation"));
				}
			);
		});
	</script>


            
        </article>
    </section>

        </div>
        <div class="col-sm-3" id="sidebar">
            <aside>

<section class="well well-sm">
    <ul class="list-group list-group-flush">
            <li class="list-group-item"><h4><i class="fa fa-home fa-lg"></i><span class="icon-label">Social</span></h4>
              <ul class="list-group" id="social">
                <li class="list-group-item"><a href="https://www.twitter.com/pintman"><i class="fa fa-twitter-square fa-lg"></i> twitter</a></li>
                <li class="list-group-item"><a href="https://twitter.bakera.de"><i class="fa fa-twitter-square fa-lg"></i> twitter Archiv</a></li>
                <li class="list-group-item"><a href="https://github.com/pintman"><i class="fa fa-github-square fa-lg"></i> github</a></li>
                <li class="list-group-item"><a href="https://github.com/tbs1-bo"><i class="fa fa-github-square fa-lg"></i> github TBS1</a></li>
                <li class="list-group-item"><a href="https://gitlab.com/pintman"><i class="fa fa-git-square fa-lg"></i> gitlab</a></li>
                <li class="list-group-item"><a href="https://edugit.org/bak"><i class="fa fa-git-square fa-lg"></i> edugit</a></li>
              </ul>
            </li>





    </ul>
</section>            </aside>
        </div>
    </div>
</div>
<footer>
   <div class="container">
      <hr>
      <div class="row">
         <div class="col-xs-10">&copy; 2018 Marco Bakera
            &middot; Powered by <a href="https://github.com/getpelican/pelican-themes/tree/master/pelican-bootstrap3" target="_blank">pelican-bootstrap3</a>,
            <a href="http://docs.getpelican.com/" target="_blank">Pelican</a>,
            <a href="http://getbootstrap.com" target="_blank">Bootstrap</a>         </div>
         <div class="col-xs-2"><p class="pull-right"><i class="fa fa-arrow-up"></i> <a href="#">Back to top</a></p></div>
      </div>
   </div>
</footer>
<script src="https://blog.bakera.de/theme/js/jquery.min.js"></script>

<!-- Include all compiled plugins (below), or include individual files as needed -->
<script src="https://blog.bakera.de/theme/js/bootstrap.min.js"></script>

<!-- Enable responsive features in IE8 with Respond.js (https://github.com/scottjehl/Respond) -->
<script src="https://blog.bakera.de/theme/js/respond.min.js"></script>


</body>
</html>