<!DOCTYPE html>
<html lang="de">
<head>
        <meta charset="utf-8" />
        <title>/home/bakera/blog - NNTP</title>
        <link rel="stylesheet" href="https://blog.bakera.de/theme/css/main.css" />
        <link href="https://blog.bakera.de/feeds/all.atom.xml" type="application/atom+xml" rel="alternate" title="/home/bakera/blog Atom Feed" />

        <!--[if IE]>
            <script src="https://html5shiv.googlecode.com/svn/trunk/html5.js"></script>
        <![endif]-->
</head>

<body id="index" class="home">
        <header id="banner" class="body">
                <h1><a href="https://blog.bakera.de/">/home/bakera/blog </a></h1>
                <nav><ul>
                    <li><a href="https://blog.bakera.de/pages/about.html">Über</a></li>
                    <li><a href="https://blog.bakera.de/pages/impressum.html">Impressum, Datenschutz</a></li>
                    <li><a href="https://blog.bakera.de/pages/wiki.html">Wiki</a></li>
                    <li><a href="https://blog.bakera.de/category/sonstiges.html">Sonstiges</a></li>
                </ul></nav>
        </header><!-- /#banner -->

            <aside id="featured" class="body">
                <article>
                    <h1 class="entry-title"><a href="https://blog.bakera.de/das-usenet-nntp-server-und-kommunikationsprotokolle.html">Das Usenet, NNTP-Server und Kommunikationsprotokolle</a></h1>
<footer class="post-info">
        <abbr class="published" title="2015-10-16T10:58:00+02:00">
                Published: Fr 16 Oktober 2015
        </abbr>

        <address class="vcard author">
                By                         <a class="url fn" href="https://blog.bakera.de/author/marcobakera.html">marco.bakera</a>
        </address>
<p>In <a href="https://blog.bakera.de/category/sonstiges.html">Sonstiges</a>.</p>
<p>tags: <a href="https://blog.bakera.de/tag/inn.html">INN</a> <a href="https://blog.bakera.de/tag/newsgroup.html">Newsgroup</a> <a href="https://blog.bakera.de/tag/nntp.html">NNTP</a> <a href="https://blog.bakera.de/tag/server.html">Server</a> <a href="https://blog.bakera.de/tag/usenet.html">Usenet</a> </p>
</footer><!-- /.post-info --><p><strong>Das Usenet ist eine alte doch immer noch interessante und lebendige
Institution des Internet - aus technischer, kultureller und auch
historischer Sicht. Ich möchte mit euch eintauchen in diese Welt und sie
als Nutzer und technisch Interessierter erkunden.</strong></p>
<p><img alt="ic_chat_black_48dp" class="alignright size-full wp-image-1870" src="images/2015/10/ic_chat_black_48dp.png" style="width: 144px; height: 144px;" />Meine <a class="reference external" href="https://www.bakera.de/wp/2013/05/digitale-emanzipation/">digitale
Emanzipation</a>
schreitet voran: Nachdem ich <a class="reference external" href="http://www.bakera.de/wp/2014/10/my-home-is-my-server/">meinen
Server</a> in die
heimischen vier Wände geholt und einen eigenen <a class="reference external" href="http://www.bakera.de/wp/2015/05/ein-eigener-jabber-server/">Jabber-Server
aufgesetzt</a>
habe, soll nun ein Newsserver als neues Projekt das heimische Netzwerk
erweitern. Doch zunächst ein paar erklärende Worte.</p>
<div class="section" id="usenet-was-es-ist-und-wie-man-es-bedient">
<h2>Usenet: Was es ist und wie man es bedient</h2>
<p>Das <a class="reference external" href="https://de.wikipedia.org/wiki/Usenet">Usenet</a> ist die große alte
Dame des Internet. Sie - also es - wurde 1979 geboren und ist damit
älter als das World Wide Web - also die bunte Welt, die man durch das
Browserfenster betrachtet. Da das Usenet älter als das WWW ist, benötigt
man ein eigenes Programm um darauf zugreifen zu können: einen
Newsreader. Damals wie heute wird das Usenet mit seinen zahlreichen
Diskussionsgruppen für den Wissensaustausch genutzt und für den
Dateiaustausch missbraucht. Es ist der <a class="reference external" href="http://www.heise.de/tp/artikel/13/13155/1.html">Geburtsort der Merkbefreiung und
Wirkenskreis von Hürbine von
Pleuselspink</a>.</p>
<p>Die Nutzerzahl ist seit dem Aufkommen sozialer Netzwerke wie Facebook
und Webforen <a class="reference external" href="http://usenet.dex.de/de.ALL.html">rückläufig</a>. Aber das
muss nichts über die Qualität der Inhalte aussagen. Vielfach findet man
dort technisch versierte und inhaltlich kompetente Nutzer, die
ausführlich und mit viel Erfahrung antworten. Außerdem kann es mit
vielen unterschiedlichen Clients benutzt werden, was die Möglichkeiten
von Filterung, Darstellung und Bedienung deutlich erweitert. Ein
Beispiel für die Qualität ist die intensive Diskussion um das Rätsel
<a class="reference external" href="https://groups.google.com/d/msg/de.rec.denksport/4uWJU6xvwH8/Snup8Kd9BwAJ">&quot;Prinzessin im
See&quot;</a>
in der Gruppe&nbsp;<em>de.rec.denksport</em>. Ich habe in den letzten Tagen ca.
100 Beiträge pro Tag in den von mir abonnierten Gruppen erhalten und
denke, dass dies ausreichend für eine lebendige Gruppenstruktur ist. Das
Usenet ist also nicht tot, es hat sich nach einem Hype am Ende der 90er
Jahre in einem stabilen Nutzungsverhalten eingependelt.</p>
<p>Ein detaillierte Darstellung des Usenet gibt das schon ältere, dafür
kostenlos erhältliche Buch <a class="reference external" href="http://www.detebe.org/usenet-buch/">Newsgroups - weltweit
diskutieren</a>, das viele
verschiedene Aspekte beschreibt: die Technik, Kommunikationsmodelle
sowie gesellschaftliche und historische Dimensionen. Das Archiv der
Beiträge seit Beginn der 80er Jahre kann z.B. mit der Suchmaschine <a class="reference external" href="http://www.theusenetarchive.com/">The
Usenet Archive</a> oder <a class="reference external" href="https://groups.google.com">Google
Groups</a> durchsucht werden.</p>
<p>Der deutsche Teil des Usenet organisiert sich in den de.*-Gruppen.
Gruppen in dieser Hierarchie werden von der
<a class="reference external" href="http://www.dana.de/">dana</a> (de.admin.news.announce) koordiniert:
also angelegt, gelöscht, zusammengefasst oder aufgesplittet.</p>
<p>Neugierig geworden? Es ist erstaunlich einfach, einen Account bei einem
Newsserver zu bekommen, der Usenet-Nachrichten verteilt. Das <a class="reference external" href="http://open-news-network.org/">Open News
Network</a> hat sich vorgenommen, freie
Zugänge für Text-Gruppen bereit zu stellen. Ich habe mir einen
kostenlosen Account beim schweizerischen Anbieter
<a class="reference external" href="http://albasani.net/">albsani.net</a> erstellt. Daneben gibt es noch
<a class="reference external" href="http://news.individual.de">individual.de</a>. Dies ist ein Anbieter der
Freien Universität Berlin. Er möchte 10 € pro Jahr für seine Dienste
haben und gilt als Urgestein der Usenetszene.</p>
<p>Nun benötige ich noch ein Programm, um auf die Gruppen zugreifen zu
können. Gott sei dank werden viele E-Mail-Programme heutzutage schon mit
einer Unterstützung für Newsgroups ab Werk ausgeliefert. So auch
Thunderbird (eine Anleitung ist
<a class="reference external" href="https://support.mozilla.org/de/kb/newsgruppen-konto-einrichten">hier</a>
und
<a class="reference external" href="https://www.thunderbird-mail.de/wiki/Newsgruppen-Konto_einrichten">hier</a>)
und <a class="reference external" href="https://support.microsoft.com/de-de/kb/956674">Windows Mail</a>.
Viele weitere Anleitungen für unterschiedliche Betriebssysteme und
Programme gibt es bei
<a class="reference external" href="http://news.individual.de/config.php">individual.de</a>. Für Android
hat mir das Programm <a class="reference external" href="http://usenet.sinaapp.com/">Usenet Newsreader</a>
gut gefallen.</p>
<p>Nach der Einrichtung kann man eine umfangreiche Gruppenliste&nbsp;(über
25.000 Gruppen!) herunterladen und ein wenig darin stöbern. Mir haben
die Gruppen unter de.* und ger.* auf den ersten Blick ganz gut
gefallen. Du musst aber selbst ein wenig suchen und nach deinen eigenen
Interessen schauen.</p>
</div>
<div class="section" id="eigener-server">
<h2>Eigener Server</h2>
<p>Aber die reine Verwendung eines Newsservers hat mir natürlich nicht
gereicht. Schließlich möchte ich meine Infrastruktur selbst gestalten
und aufbauen. Also musste ein eigener Newsserver her. Hier ist
<a class="reference external" href="http://www.eyrie.org/~eagle/software/inn/">INN</a> der de-facto
Standard - in Version 2 heißt das Paket auch häufig <em>inn2</em> in den
Distributionen. Die Freifunker haben eine schöne
<a class="reference external" href="https://wiki.freifunk.net/Newsserver_einrichten">Anleitung</a> für die
Einrichtung geschrieben. Dass die Konfiguration so ihre Tücken aufweist
zeigt ein <a class="reference external" href="http://www.freebsddiary.org/inn.php">Beitrag aus dem
FreeBSD-Diary</a>. Er stellt die
üblichen Stolperstellen vor und gibt Hinweise darauf, wie man sie
umgehen kann.</p>
<p>Es geht aber auch einfacher - und zwar mit dem Server
<a class="reference external" href="https://github.com/cdpxe/WendzelNNTPd/releases">WendzelNNTPd</a>. Der
Server lässt sich einfach installieren und hat wenig Ansprüche. Außerdem
reagierte der Autor Steffen Wendzel bei meinen Recherche extrem schnell
auf Anfragen und Probleme. Innerhalb von Stunden war mir geholfen. Eine
Installationsanleitung hat Steffen Wendzel selbst in dem <a class="reference external" href="http://openbook.rheinwerk-verlag.de/linux/linux_kap17_004.html#dodtp519616a1-d189-4793-b529-e6527490a15a">Kapitel zu
NNTP-Servern</a>
des Buches &quot;Linux - das umfassende Handbuch&quot; (Rheinwerk Verlag)
geschrieben.</p>
<p>Das Programm wird nicht als Paket ausgeliefert, sondern muss mit einem
C-Compiler kompiliert werden. Das ist einfacher als es sich anhört, da
vieles automatisch abläuft. Zunächst laden wir den Quelltext aus dem
<a class="reference external" href="https://github.com/cdpxe/WendzelNNTPd/releases">git-repo</a>&nbsp; herunter
und entpacken das Archiv.</p>
<p>Es werden noch ein paar Bibliotheken benötigt, die wir leicht
installieren können.</p>
<pre class="literal-block">
$ sudo apt-get install gcc flex bison libsqlite3-dev make
</pre>
<p>Als Backend für die Daten kommen eine SQLite- oder MySQL-Datenbank in
Frage. Die Nachrichten selbst werden als Textdateien abgespeichert. In
der Datenbank werden nur Zugangsdaten sowie die Verlinkungsstruktur der
Nachrichten untereinander und die Zuordnung zu den Diskussionsgruppen
realisiert. Ich entscheide mich für eine leichtgewichtige Variante mit
SQLite und werfe das Konfigurationsskript an.</p>
<pre class="literal-block">
$ MYSQL=NO ./configure
</pre>
<p>Sollten nun immer noch Bibliotheken fehlen, meldet sich das Skript und
sagt genau, was es noch benötigt. Danach kann ich die Software
kompilieren und nach <em>/usr/local</em> installieren lassen.</p>
<pre class="literal-block">
$ make
$ sudo make install
</pre>
<p>Im Sourcenpaket ist noch ein init-skript, das ich an die richtige Stelle
kopiere.</p>
<pre class="literal-block">
$ sudo cp ~/src/WendzelNNTPd-2.0.5/WendzelNNTPd-OSE/scripts/startup/init.d_script /etc/init.d/wendzelnntpd
</pre>
<p>Nun kann ich den Dämon ein erstes mal starten.</p>
<pre class="literal-block">
$ sudo /etc/init.d/wendzelnntpd start
</pre>
<p>Damit der Dienst auch nach einem Reboot läuft, starte ich ihn für
runlevel 2. Dazu lege ich einen symbolischen Link auf das Init-Skript
an.</p>
<pre class="literal-block">
/etc/rc2.d$ ln -s ../init.d/wendzelnntpd S92wendzelnttpd
</pre>
<p>Damit der Dienst auch bei einem Shutdown (runlevel 0) und einem reboot
(runlevel 6) sorgfältig heruntergefahren wird, sorge ich für Links an
den korrekten Stellen in den rc-Verzeichnissen.</p>
<pre class="literal-block">
/etc/rc0.d$ sudo ln -s ../init.d/wendzelnntpd K20wendzelnntpd
/etc/rc6.d$ sudo ln -s ../init.d/wendzelnntpd K20wendzelnntpd
</pre>
<p>Nun können wir die Konfigurationsdatei in
<em>/usr/local/etc/wendzelnntpd.conf</em> anpassen. Wir müssen zunächst mit
<em>listen</em> dafür sorgen, dass der Newsserver von außen erreichbar ist.
Damit er nicht sofort Ziel von ungebetenen Nutzern wird, aktiviere ich
zudem die Benutzerauthentifikation.</p>
<pre class="literal-block">
listen 192.168.178.60
use-authentication
</pre>
<p>Wir starten den Dämon nach unseren Änderungen neu.</p>
<pre class="literal-block">
$ sudo /etc/init.d/wendzelnntpd restart
</pre>
<p>Nun können wir einen ersten Nutzer und eine erste Gruppe anlegen.
Hierbei hilft das Administrationstool <em>wendzelnntpadm</em> weiter.</p>
<pre class="literal-block">
$ sudo wendzelnntpadm adduser marco PASSWORT
$ sudo wendzelnntpadm addgroup de.bakera.test y
</pre>
<p>Das 'y' hinter der Gruppe besagt, dass in diese Gruppe geschrieben
werden darf. Da schon zu Beginn ein paar Gruppen vorhanden sind, lösche
ich diese noch.</p>
<pre class="literal-block">
$ sudo wendzelnntpadm delgroup alt.wendzelnntpd.test
</pre>
<p>Damit der Server auch hinter meiner Fritz-Box erreichbar ist, habe ich
im DNS noch den Eintrag <em>news.bakera.de</em> ergänzt und eine
Portweiterleitung auf Port 119 im Router eingerichtet. Nun kann einer
Nutzung des Servers nichts mehr im Wege stehen.</p>
<p>Die Nachrichten werden im Verzeichnis <em>/var/spool/news/wendzelnntpd</em>
abgelegt. Für jede Nachricht existiert dort eine Datei mit einer
eindeutigen Message-ID. Weitere Informationen über den Ort der Nachricht
oder deren Headerdaten&nbsp; werden bei einer sqlite-Installation in der
Datei <em>usenet.db</em> abgelegt. Die Tabelle kann man sich mit einem
sqlite-Client leicht anschauen. Man entdeckt folgende Tabellen mit den
entsprechenden Attributen.</p>
<pre class="literal-block">
newsgroups (id, name, pflag, high)
ngposts (msgid, ng, postnum)              PRIMARY KEY(msgid, ng)
postings (msgid, date, author, newsgroups, subject, lines, header)
users (name, password)
roles (role)
users2roles (username, role) PRIMARY KEY(username, role)
acl_users (username, ng)                 PRIMARY KEY(username, ng)
acl_roles (role, ng)                     PRIMARY KEY(role, ng)
</pre>
</div>
<div class="section" id="kommunikationsprotokoll">
<h2>Kommunikationsprotokoll</h2>
<p>Da das Protokoll NTTP, das der Newsserver spricht, sehr einfach
aufgebaut ist, können wir sogar direkt über Telnet mit dem Server
kommunizieren. Unten sehen wir eine Beispielsitzung. Meine eigenen
Eingaben habe ich fett hervorgehoben. Der Rest sind Antworten des
Servers. Eine ausführliche Kommunikation findet ihr auch auf Seite 95
des oben erwähnten
<a class="reference external" href="http://www.detebe.org/usenet-buch/docs/Newsgroups-Buch.pdf">Usenet-Buches</a>.</p>
<pre class="literal-block">
telnet news.bakera.de 119
Trying 79.226.231.205...
Connected to news.bakera.de.
Escape character is '^]'.
200 WendzelNNTPd-OSE (Open Source Edition) 2.0.5 'Auckland' - (Sep 26 2015 06:42:09 #2517) ready (posting ok).
AUTHINFO USER marco
381 More authentication information required.
AUTHINFO PASS *****
281 Authentication accepted.
HELP
100 help text follows
--
 article [number|&lt;message-id&gt;]
 authinfo &lt;user|pass&gt; &lt;username|password&gt;
 body [number|&lt;message-id&gt;]
 date
 group &lt;group&gt;
 head [number|&lt;message-id&gt;]
 help
 list [overview.fmt|newsgroups [wildmat*]]
 listgroup [group]
 mode reader (always returns 200)
 post
 quit
 stat [number|&lt;message-id&gt;]
 xhdr &lt;from|date|newsgroups|subject|lines&gt; &lt;number[-[endnum]]|msgid&gt;
 xover &lt;from[-[to]]&gt;
 xgtitle [wildmat*] (equals LIST NEWSGROUPS but return code differs)
--
Send questions and problems to &lt;swendzel [at] ploetner-it [dot] de&gt;
Website: http://www.wendzel.de/software/wendzelnntpd.html
Notes:
* Wildmat format is based on the used regex library and is not 100%
 wildmat format compatible (XGTITLE *x -&gt; XGTITLE .*x)!
.
DATE
111 20150927185030
LIST
215 list of newsgroups follows
de.bakera.test 2 1 y
.
POST
340 send article to be posted. End with &lt;CR-LF&gt;.&lt;CR-LF&gt;
From: marco&#64;bakera.de
Newsgroups: de.bakera.test
Subject: Ein Test

Ein Testartikel.
.
240 article posted
</pre>
</div>
                </article>
            </aside><!-- /#featured -->
        <section id="extras" class="body">
                <div class="social">
                        <h2>social</h2>
                        <ul>
                            <li><a href="https://blog.bakera.de/feeds/all.atom.xml" type="application/atom+xml" rel="alternate">atom feed</a></li>

                        </ul>
                </div><!-- /.social -->
        </section><!-- /#extras -->

        <footer id="contentinfo" class="body">
                <address id="about" class="vcard body">
                Proudly powered by <a href="http://getpelican.com/">Pelican</a>, which takes great advantage of <a href="http://python.org">Python</a>.
                </address><!-- /#about -->

                <p>The theme is by <a href="http://coding.smashingmagazine.com/2009/08/04/designing-a-html-5-layout-from-scratch/">Smashing Magazine</a>, thanks!</p>
        </footer><!-- /#contentinfo -->

</body>
</html>